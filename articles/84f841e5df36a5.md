---
title: "Flutter ã® AppBar ã®ä¸­ã®ç”»åƒãŒæŒ‡å®šã—ãŸã‚µã‚¤ã‚ºã§è¡¨ç¤ºã•ã‚Œãªã„"
emoji: "ğŸ¤”"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["flutter", "dart", "adventcalendar2024"]
published: true
---

[Flutter Advent Calendar 2024] ã® 20 æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚

## ã‚„ã‚ŠãŸã„ã“ã¨

ä»¥ä¸‹ã®ã‚ˆã†ã« `AppBar` ã® `leading` ã«æŒ‡å®šã—ãŸã‚µã‚¤ã‚ºã®ç”»åƒã‚’è¡¨ç¤ºã—ãŸã„ï¼

![](/images/84f841e5df36a5/wrap_with_center.png =240x)

## ã‚„ã£ã¦ã¿ã‚ˆã†

é©å½“ãªç”»åƒã‚’ [Google Fonts ã® Material Symbols] ãªã©ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã¾ã™ã€‚

ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸç”»åƒã¯ Flutter ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® `assets/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã¦ `pubspec.yaml` ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã™ã€‚

```diff
flutter:
  uses-material-design: true
+ assets:
+   - assets/
```

æ¬¡ã«ãƒ›ãƒ¼ãƒ ç”»é¢ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ä½œæˆã—ã¦ã€ã‚¢ã‚¤ã‚³ãƒ³ãŒ 40x40 ã§è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```dart
class HomeScreen extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    final image = Image.asset(
      'assets/dash.png',
      color: Colors.black,
      width: 40,
      height: 40,
    );
    return Scaffold(
      appBar: AppBar(
        leading: image,
        title: Text('ã‚¿ã‚¤ãƒˆãƒ«),
      ),
    );
  }
}
```

ã¯ã˜ã‚ã«è¡¨ç¤ºã•ã‚Œã‚‹ç”»é¢ã‚’ãƒ›ãƒ¼ãƒ ç”»é¢ã«è¨­å®šã—ãŸã‚‰ã€ã‚ã¨ã¯ã‚¢ãƒ—ãƒªã‚’å®Ÿè¡Œã™ã‚‹ã®ã¿ï¼

ğŸš€ ã‚¢ãƒ—ãƒªå®Ÿè¡Œ ğŸš€

| æœŸå¾… | çµæœ |
| ---- | ---- |
| ![](/images/84f841e5df36a5/wrap_with_center.png =240x) | ![](/images/84f841e5df36a5/unwrapped.png =240x) |

ã‚ã‚Œã‚Œãƒ¼ï¼ŸãŠã‹ã—ã„ããƒ¼ï¼Ÿ

ã‚µã‚¤ã‚ºãŒæœŸå¾…ã—ã¦ã„ã‚‹ã‚ˆã‚Šå¤§ãããªã£ã¦ã—ã¾ã£ã¦ã„ã‚‹ã€ã€orz

## åŸå› èª¿æŸ»

ã©ã†ã‚„ã‚‰ `AppBar` ã® `leading` ã«ç”»åƒã‚’æŒ‡å®šã—ãŸå ´åˆã€ãã®ç”»åƒã®ã‚µã‚¤ã‚ºãŒ `AppBar` ã®ã‚µã‚¤ã‚ºã«åˆã‚ã›ã¦æ‹¡å¤§ã•ã‚Œã¦ã—ã¾ã†ã‚ˆã†ã§ã™ã€‚

ãªãœã€ã“ã®ã‚ˆã†ãªæŒ™å‹•ã«ãªã‚‹ã®ã‹ã€ã²ã¨ã¾ãš [AppBar ã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ] ã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

`AppBar` ã®æ§‹æˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¦ã€ä»Šå›ç”»åƒã‚’è¨­å®šã—ãŸã®ã¯ `leading` ã§ã™ã€‚

![](/images/84f841e5df36a5/appbar_structure.png =480x)

[AppBar ã® leading ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ] ã‚’ç¢ºèªã—ã¦ã¿ã‚‹ã¨ã€`leading` ã«æŒ‡å®šã—ãŸã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã¯ `NavigationToolbar` ã® `leading` ã¸æ¸¡ã•ã‚Œã€ãã®ã‚µã‚¤ã‚ºã¯ `leadingWidth` ã¨ `toolbarHeight` ã«ã‚ˆã£ã¦åˆ¶é™ã•ã‚Œã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã—ãŸã€‚

ã—ã‹ã—ã€ã“ã‚Œã ã‘ã§ã¯ãªãœè¨­å®šã—ãŸç”»åƒã®ã‚µã‚¤ã‚ºãŒæ‹¡å¤§ã•ã‚Œã¦ã—ã¾ã†ã®ã‹ã¯åˆ†ã‹ã‚Šã¾ã›ã‚“ã€‚

ã‚‚ã†å°‘ã—æ·±ã„ã¨ã“ã‚ã¾ã§æ¢ã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼

`AppBar` ã®å®Ÿè£…éƒ¨åˆ†ã‚’çœºã‚ã¦ã¿ã‚‹ã¨ `leading` ã«ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã‚’æ¸¡ã—ã¦ã€ä»¥ä¸‹ã®å‡¦ç†ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã—ãŸã€‚

```dart
if (leading != null) {
  if (theme.useMaterial3) {
    final IconButtonThemeData effectiveIconButtonTheme;

    // This comparison is to check if there is a custom [overallIconTheme]. If true, it means that no
    // custom [overallIconTheme] is provided, so [iconButtonTheme] is applied. Otherwise, we generate
    // a new [IconButtonThemeData] based on the values from [overallIconTheme]. If [iconButtonTheme] only
    // has null values, the default [overallIconTheme] will be applied below by [IconTheme.merge]
    if (overallIconTheme == defaults.iconTheme) {
      effectiveIconButtonTheme = iconButtonTheme;
    } else {
      // The [IconButton.styleFrom] method is used to generate a correct [overlayColor] based on the [foregroundColor].
      final ButtonStyle leadingIconButtonStyle = IconButton.styleFrom(
        foregroundColor: overallIconTheme.color,
        iconSize: overallIconTheme.size,
      );

      effectiveIconButtonTheme = IconButtonThemeData(
        style: iconButtonTheme.style?.copyWith(
          foregroundColor: leadingIconButtonStyle.foregroundColor,
          overlayColor: leadingIconButtonStyle.overlayColor,
          iconSize: leadingIconButtonStyle.iconSize,
        )
      );
    }

    leading = IconButtonTheme(
        data: effectiveIconButtonTheme,
        child: leading is IconButton ? Center(child: leading) : leading,
    );

    // Based on the Material Design 3 specs, the leading IconButton should have
    // a size of 48x48, and a highlight size of 40x40. Users can also put other
    // type of widgets on leading with the original config.
    leading = ConstrainedBox(
      constraints: BoxConstraints.tightFor(width: widget.leadingWidth ?? _kLeadingWidth),
      child: leading,
    );
  } else {
    leading = ConstrainedBox(
      constraints: BoxConstraints.tightFor(width: widget.leadingWidth ?? _kLeadingWidth),
      child: leading,
    );
  }
}
```

ã“ã®ä¸­ã§ã‚‚ç‰¹ã«æ³¨ç›®ã™ã¹ããªã®ã¯ã€ä»¥ä¸‹ã®éƒ¨åˆ†ã§ã™ã€‚

```dart
leading = ConstrainedBox(
  constraints: BoxConstraints.tightFor(width: widget.leadingWidth ?? _kLeadingWidth),
  child: leading,
);
```

`leading` ã‚’ `ConstrainedBox` ã§å›²ã£ã¦ `BoxConstraints.tightFor()` ã‚’é©ç”¨ã™ã‚‹ã“ã¨ã§æ¨ªå¹…ã®æœ€å¤§ãƒ»æœ€å°å€¤ã‚’ `_kLeadingWidth` ( 56 ) ã«è¨­å®šã—ã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚ã“ã®ã‚ˆã†ã«è¨­å®šã™ã‚‹ã¨ã€`ConstrainedBox` ã®ç›´ä¸‹ã«ã‚ã‚‹ç”»åƒã¯ `_kLeadingWidth` ã®ã‚µã‚¤ã‚ºã«åˆã‚ã›ã¦æ‹¡å¤§ã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚

ã¤ã¾ã‚Šã€ä»¥ä¸‹ã®ã‚ˆã†ã«ç”»åƒã‚’ `ConstrainedBox` ã§å›²ã£ã¦ `BoxConstraints.tightFor()` ã‚’é©ç”¨ã™ã‚Œã°å†ç¾ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

![](/images/84f841e5df36a5/example1.png =960x)

## è§£æ±ºæ–¹æ³•

ã§ã¯ã€ã©ã†ã™ã‚Œã°ç”»åƒã®ã‚µã‚¤ã‚ºã‚’åˆ¶é™ã§ãã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ

å…ˆã»ã©ã® `AppBar` ã®å®Ÿè£…éƒ¨åˆ†ã‚’ã‚ˆãã‚ˆãè¦‹ã¦ã¿ã‚‹ã¨ã€ã¨ã‚ã‚‹ã“ã¨ã«æ°—ã¥ãã¾ã™ã€‚

```dart
leading = IconButtonTheme(
    data: effectiveIconButtonTheme,
    child: leading is IconButton ? Center(child: leading) : leading,
);
```

`leading` ãŒ `IconButton` ã®å ´åˆã¯ `Center` ã§å›²ã‚€ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã®ã§ã™ã€‚

ãã†ã§ã™ã€‚å®Ÿã¯ `Center` ã§å›²ã‚€ã“ã¨ã§ç”»åƒã®ã‚µã‚¤ã‚ºãŒ `_kLeadingWidth` ã«åˆã‚ã›ã¦æ‹¡å¤§ã•ã‚Œã‚‹ã“ã¨ã‚’é˜²ãã“ã¨ãŒã§ãã¾ã™ã€‚

å…ˆã»ã©ã®å†ç¾ä¾‹ã‚’ `Center` ã§å›²ã‚“ã§ã¿ã¾ã—ã‚‡ã†ã€‚ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«æœŸå¾…é€šã‚Šã®ã‚µã‚¤ã‚ºã§è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸ ğŸ‰

![](/images/84f841e5df36a5/example2.png =960x)

ãªãœã€è§£æ±ºã§ããŸã‹ã¨ã„ã†ã¨ `ConstrainedBox` ã® `BoxConstraints.tightFor()` ã®åˆ¶ç´„ã¯ `Center` ã¸é©ç”¨ã•ã‚Œã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã¨ã€`Center` ã¯å­ã®ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã®ä½ç½®ã‚’å¤‰ãˆã‚‹ã ã‘ã§ã‚µã‚¤ã‚ºã«ã¯å½±éŸ¿ã‚’ä¸ãˆãªã„ãŸã‚ã§ã™ã€‚

å®Ÿéš›ã« Widget Inspector ã§ç¢ºèªã—ã¦ã¿ã‚‹ã¨ `Center` ã®ã‚µã‚¤ã‚ºã¯ `_kLeadingWidth` ã«åˆã‚ã›ã¦æ‹¡å¤§ã•ã‚Œã¦ã„ã¾ã™ãŒã€å­ã®ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã®ã‚µã‚¤ã‚ºã¯å¤‰ã‚ã£ã¦ã„ãªã„ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚

| Center ã®ã‚µã‚¤ã‚º | Center ã®å­ã®ã‚µã‚¤ã‚º |
| ---- | ---- |
| ![](/images/84f841e5df36a5/center_widget_size.png =240x) | ![](/images/84f841e5df36a5/center_child_widget_size.png =240x) |

ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã«ã‚ã‚Šã¾ã™ã®ã§ã€å‚è€ƒã¾ã§ã«ã©ã†ãã”è¦§ãã ã•ã„ã€‚

https://github.com/blendthink/appbar-image-size

## ãŠã‚ã‚Šã«

ä»Šå›ã¯ Flutter ã® `AppBar` ã® `leading` ã«ç”»åƒã‚’è¡¨ç¤ºã™ã‚‹éš›ã«é­é‡ã—ãŸå•é¡Œã¨ãã®è§£æ±ºæ–¹æ³•ã«ã¤ã„ã¦ç´¹ä»‹ã—ã¾ã—ãŸã€‚

ä¸»ãªãƒã‚¤ãƒ³ãƒˆã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š

- `AppBar` ã® `leading` ã«ç”»åƒã‚’ç›´æ¥æŒ‡å®šã™ã‚‹ã¨ã€`_kLeadingWidth` (56) ã®ã‚µã‚¤ã‚ºã«æ‹¡å¤§ã•ã‚Œã¾ã™
- ç”»åƒã‚’ `Center` ã§å›²ã‚€ã“ã¨ã«ã‚ˆã£ã¦ã€æŒ‡å®šã—ãŸã‚µã‚¤ã‚ºã®ã¾ã¾è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™
- ã“ã‚Œã¯ `ConstrainedBox` ã¨ `Center` ãã‚Œãã‚Œã®ç‰¹æ€§ã«ã‚ˆã£ã¦èµ·ã“ã‚‹ç¾è±¡ã§ã™

ã“ã®è¨˜äº‹ãŒã€åŒã˜ã‚ˆã†ãªå•é¡Œã§ãŠå›°ã‚Šã®æ–¹ã€…ã®å‚è€ƒã«å°‘ã—ã§ã‚‚ãªã‚Œã°å¹¸ã„ã§ã™ã€‚

<!-- Links -->

[Flutter Advent Calendar 2024]: https://qiita.com/advent-calendar/2024/flutter

[Google Fonts ã® Material Symbols]: https://fonts.google.com/icons

[AppBar ã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ]: https://api.flutter.dev/flutter/material/AppBar-class.html

[AppBar ã® leading ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ]: https://api.flutter.dev/flutter/material/AppBar/leading.html
