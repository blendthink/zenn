---
title: "GitHub Actions ã§çœŸå½å€¤åˆ¤å®šã®æ³¨æ„ç‚¹"
emoji: "ğŸ›"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [ "github", "githubactions" ]
published: true
---

## ã¯ã˜ã‚ã«

GitHub Actions ã®çœŸå½å€¤åˆ¤å®šãŒã‚„ã‚„ã“ã—ã‹ã£ãŸãŸã‚ã€å‚™å¿˜éŒ²ã¨ã—ã¦æ®‹ã—ã¦ãŠãã¾ã™ã€‚

## å®Ÿé¨“

ä»¥ä¸‹ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã©ã†ãªã‚‹ã®ã§ã—ã‚‡ã†ã‹ã€‚

```yaml
name: expression

on:
  workflow_dispatch:

jobs:
  expression:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        enabled: [ true, false ]

    steps:
      - id: check
        run: echo "::set-output name=enabled::${{ matrix.enabled }}"

      - if: steps.check.outputs.enabled
        name: executed 1
        run: echo "executed 1"

      # ${{ }} å†…ã§ãªã‘ã‚Œã°ã€YAML ã®ä»•æ§˜ã«ã‚ˆã‚Š `!` ã¯å¦å®šæ¼”ç®—å­ã§ã¯ãªã
      # ã‚¿ã‚°ã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹ãŸã‚ã€ã“ã®è¨˜è¿°ã¯æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã—ã¾ã†
      # å‚è€ƒ: https://github.com/yaml/yaml-spec
      #
      # - if: !steps.check.outputs.enabled
      #   name: executed 2
      #   run: echo "executed 2"

      - if: ${{ steps.check.outputs.enabled }}
        name: executed 3
        run: echo "executed 3"

      - if: ${{ !steps.check.outputs.enabled }}
        name: executed 4
        run: echo "executed 4"

      - if: steps.check.outputs.enabled == true
        name: executed 5
        run: echo "executed 5"

      - if: steps.check.outputs.enabled != true
        name: executed 6
        run: echo "executed 6"

      - if: steps.check.outputs.enabled == false
        name: executed 7
        run: echo "executed 7"

      - if: steps.check.outputs.enabled != false
        name: executed 8
        run: echo "executed 8"

      - if: steps.check.outputs.enabled == 'true'
        name: executed 9
        run: echo "executed 9"

      - if: steps.check.outputs.enabled != 'true'
        name: executed 10
        run: echo "executed 10"

      - if: steps.check.outputs.enabled == 'false'
        name: executed 11
        run: echo "executed 11"

      - if: steps.check.outputs.enabled != 'false'
        name: executed 12
        run: echo "executed 12"
```

## äºˆæƒ³

ç§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«äºˆæƒ³ã—ã¦ã„ã¾ã—ãŸã€‚

| enabled | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   | 10  | 11  | 12  |
|---------|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| true    | â—‹   | -   | â—‹   | Ã—   | â—‹   | Ã—   | Ã—   | â—‹   | â—‹   | Ã—   | Ã—   | â—‹   |
| false   | Ã—   | -   | Ã—   | â—‹   | Ã—   | â—‹   | â—‹   | Ã—   | Ã—   | â—‹   | â—‹   | Ã—   |

## çµæœ

äºˆæƒ³ã¨ã¯é•ã£ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

| enabled | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   | 10  | 11  | 12  |
|---------|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| true    | â—‹   | -   | â—‹   | Ã—   | Ã—   | â—‹   | Ã—   | â—‹   | â—‹   | Ã—   | Ã—   | â—‹   |
| false   | â—‹   | -   | â—‹   | Ã—   | Ã—   | â—‹   | Ã—   | â—‹   | Ã—   | â—‹   | â—‹   | Ã—   |

| true                                         | false                                         |
|----------------------------------------------|-----------------------------------------------|
| ![](/images/2116c9192f75db/enabled_true.png) | ![](/images/2116c9192f75db/enabled_false.png) |


## è§£èª¬

ã©ã†ã„ã†ã“ã¨ãªã®ã‹ã€‚åŸå› ã¯ï¼“ã¤ã‚ã‚Šã¾ã™ã€‚

- `steps.xxx.outputs` ã«çœŸå½å€¤ã‚’å…¥ã‚Œã¦ã‚‚æ–‡å­—åˆ—ã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹
- `if: {æ–‡å­—åˆ—}` ã¯ `{æ–‡å­—åˆ—}` ã®é•·ã•ã«é–¢ã‚ã‚‰ãšã€å¿…ãšçœŸã«ãªã‚‹
- `true == 'true'` ã¯å½ã«ãªã‚Šã€`true != 'true'` ã¯çœŸã«ãªã‚‹

## ç¢ºèª

**ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚®ãƒ³ã‚°ã®æœ‰åŠ¹åŒ–** ã®è¨­å®šã‚’ã—ã¾ã™ã€‚

https://docs.github.com/ja/actions/monitoring-and-troubleshooting-workflows/enabling-debug-logging

Settings â†’ Secrets â†’ Actions â†’ New repository secret ã® Name ã« `ACTIONS_STEP_DEBUG`ã€Value ã« `true` ã‚’è¨­å®šã—ã¾ã™ã€‚

| Actions secrets                         | New repository secret                       |
|-----------------------------------------|---------------------------------------------|
| ![](/images/2116c9192f75db/secrets.png) | ![](/images/2116c9192f75db/secrets_new.png) |

ã“ã®è¨­å®šã‚’ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€å€¤ãŒã©ã®ã‚ˆã†ã«å¤‰åŒ–ãƒ»å—ã‘æ¸¡ã—ãƒ»æ¯”è¼ƒã•ã‚Œã¦ã„ã‚‹ã®ã‹ã€ãªã©ã®ã‚ˆã‚Šè©³ã—ã„æƒ…å ±ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### ãƒ‡ãƒ¢

https://github.com/blendthink/github-actions-expression-demo/actions/runs/2783203755

ã“ã®ã‚ˆã†ã«è©³ç´°ãªãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

![](/images/2116c9192f75db/demo.png)

## ãŠã‚ã‚Šã«

ã“ã‚Œã¯ã‚„ã‚„ã“ã—ã™ãã¾ã™ã‚ˆã­ã€‚ã€‚
å°‘ã—ã§ã‚‚ã¿ãªã•ã‚“ã®ãŠå½¹ã«ç«‹ã¦ã‚Œã°å¹¸ã„ã§ã™ã€‚

### å‚è€ƒ

https://docs.github.com/ja/actions/learn-github-actions/expressions

https://github.com/actions/runner/issues/1483#issuecomment-994986996
